define("dsy/util/1.1.2/historyUtil",function(){"use strict";var vars=seajs.data.vars;if(!vars.localStorage){var ls=window.localStorage;try{ls&&ls.setItem("testPrivateModel",!1)}catch(e){console.log("not support localStorage!"),ls=null}vars.localStorage=ls}if(!vars.sessionStorage){var ss=window.sessionStorage;try{ss&&ss.setItem("testPrivateModel",!1)}catch(e){console.log("not support sessionStorage!"),ss=null}vars.sessionStorage=ss}var historyUtil=function(){this.HISTORY_COUNT=10,this.historyObject={key:"",hrefUrl:"",adUrl:"",type:"",tag:"",suffix:"",ext:""}};return historyUtil.prototype.stringifyJSON=function(obj){return JSON.stringify(obj)},historyUtil.prototype.parseJSON=function(str){return JSON.parse(str)},historyUtil.prototype.getHistory=function(key){var historyItems=[];return vars.localStorage&&(historyItems=vars.localStorage.getItem(key),historyItems=historyItems?this.parseJSON(historyItems):[]),historyItems},historyUtil.prototype.getLastHistory=function(key){var historyItems=this.getHistory(key);return historyItems?historyItems[0]:""},historyUtil.prototype.getFirstHistory=function(key){var historyItems=this.getHistory(key);return historyItems?historyItems[historyItems.length-1]:""},historyUtil.prototype.queryHistory=function(key,val){for(var historyItems=this.getHistory(key),length=historyItems.length;length--;){var item=historyItems[length];if(item.key===val)return item}return null},historyUtil.prototype.setHistory=function(key,obj){if(vars.localStorage){var thatObj=this.formatHistoryObject(obj),historyItems=vars.localStorage.getItem(key);if(historyItems){historyItems=this.parseJSON(historyItems);for(var length=historyItems.length,i=length-1;i>=0;i--)this.hasSameHistory(thatObj,historyItems[i])&&historyItems.splice(i,1)}else historyItems=[];historyItems.unshift(thatObj),historyItems.length>this.HISTORY_COUNT&&historyItems.pop(),vars.localStorage.setItem(key,this.stringifyJSON(historyItems))}},historyUtil.prototype.hasSameHistory=function(a,b){var obj=this.historyObject;for(var key in obj)if(obj.hasOwnProperty(key)&&"hrefUrl"!==key&&a[key]!==b[key])return!1;return!0},historyUtil.prototype.formatHistoryObject=function(obj){var o={};for(var key in this.historyObject)this.historyObject.hasOwnProperty(key)&&(o[key]=obj[key]||"");return o.timestamp=(new Date).getTime().toString(),o},historyUtil.prototype.removeHistoryItem=function(key,index){var hitstoryItems=vars.localStorage.getItem(key);hitstoryItems=this.parseJSON(hitstoryItems);var length=$.isArray(hitstoryItems)?hitstoryItems.length:0,isClear=!1;return 1===length?(isClear=!0,this.clearHistory(key)):(hitstoryItems.splice(index,1),vars.localStorage.setItem(key,this.stringifyJSON(hitstoryItems))),isClear},historyUtil.prototype.clearHistory=function(key){vars.localStorage&&vars.localStorage.removeItem(key)},historyUtil.prototype.setSession=function(key,val){vars.sessionStorage&&vars.sessionStorage.setItem(key,JSON.stringify(val))},historyUtil.prototype.getSession=function(key){if(vars.sessionStorage)return JSON.parse(vars.sessionStorage.getItem(key))},new historyUtil});