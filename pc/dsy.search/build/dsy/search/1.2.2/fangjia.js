define("dsy/search/1.2.2/fangjia",["dsy/search/1.2.2/interface"],function(e,t,r){"use strict";function s(){c.call(this),this.tag="fangjia",this.suffix="\u623f\u4ef7",this.init()}var a=seajs.data.vars,c=e("dsy/search/1.2.2/interface");s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.prototype.init=function(){this.tpl=["<tr data-key=\"{{search_key}}\" data-search='{{search_object}}'>",'<th><p>{{suggest_word}}&nbsp;<span class="gray9">{{suggest_district}}</span></p></th>',"<td><p>{{suggest_count}}</p></td>","</tr>"].join(""),this.defaultText=a.searchDefaultText.fangjia,this.historyKey=this.getHistoryKey(this.tag)},s.prototype.formatSearch=function(e){var t=this;return{key:e.key||"",hrefUrl:e.hrefUrl||"",district:e.district||"",comerce:e.comerce||"",tag:t.tag,suffix:t.suffix}},s.prototype.getSuggestHtml=function(e){var t=this,r=e.split(","),s="",a=r.length;if(t.hrefCode="",t.hrefKey="",a){for(var c=[],i=0;i<a;i++){c=r[i].split("^");var o=t.formatSearch({key:c[0],district:c[1],comerce:c[2]}),h=t.tpl;h=h.replace("{{search_key}}",o.key),h=h.replace("{{search_object}}",JSON.stringify(o)),h=h.replace("{{suggest_word}}",o.key),h=h.replace("{{suggest_district}}",o.district+" "+o.comerce);var f=c[3];f=+f>0?"\u7ea6"+f+"\u6761\u623f\u6e90\u6837\u672c":"",h=h.replace("{{suggest_count}}",f),s+=h}1===a&&(t.hrefCode=c[4],t.hrefKey=c[0])}t.suggestHtml=s},s.prototype.searchByKey=function(e,t){var r=this,s="http://fangjia.fang.com/pinggu/ajax/searchtransfer.aspx",c=a.cityName;c&&"\u5168\u56fd"!==c||(c="\u5317\u4eac");var i=a.cityCode;i&&"quanguo"!==i||(i="bj"),t&&t.hrefUrl?s=t.hrefUrl:e&&e!==r.defaultText?(s=s+"?strcity="+escape(c)+"&projname="+escape(e),r.hrefCode&&r.hrefKey&&r.hrefKey===e&&(s="http://fangjia.fang.com/process/"+i+"/"+r.hrefCode+".htm")):s=s+"?strcity="+escape(c),this.openUrl(e,s);var o=t;r.hrefCode?o=r.formatSearch({key:e,hrefUrl:s}):t||(o=r.formatSearch({key:e})),r.setHistory(e,o)},r.exports=new s});