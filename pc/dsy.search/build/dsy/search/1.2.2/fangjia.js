define("dsy/search/1.2.2/fangjia",["dsy/search/1.2.2/interface"],function(e,t,r){"use strict";function a(){c.call(this),this.tag="fangjia",this.suffix="\u623f\u4ef7",this.init()}var s=seajs.data.vars,c=e("dsy/search/1.2.2/interface");a.prototype=Object.create(c.prototype),a.prototype.constructor=a,a.prototype.init=function(){this.tpl=["<tr data-key=\"{{search_key}}\" data-search='{{search_object}}'>",'<th><p>{{suggest_word}}&nbsp;<span class="gray9">{{suggest_district}}</span></p></th>',"<td><p>{{suggest_count}}</p></td>","</tr>"].join(""),this.defaultText=s.searchDefaultText.fangjia,this.historyKey=this.getHistoryKey(this.tag)},a.prototype.formatSearch=function(e){var t=this;return{key:e.key||"",hrefUrl:e.hrefUrl||"",district:e.district||"",comerce:e.comerce||"",tag:t.tag,suffix:t.suffix}},a.prototype.getSuggestHtml=function(e){var t=this,r=e.split(","),a="",s=r.length;if(t.hrefCode="",t.hrefKey="",s){for(var c=[],i=0;i<s;i++){c=r[i].split("^");var o=t.formatSearch({key:c[0],district:c[1],comerce:c[2]}),f=t.tpl;f=f.replace("{{search_key}}",o.key),f=f.replace("{{search_object}}",JSON.stringify(o)),f=f.replace("{{suggest_word}}",o.key),f=f.replace("{{suggest_district}}",o.district+" "+o.comerce);var h=c[3];h=+h>0?"\u7ea6"+h+"\u6761\u623f\u6e90\u6837\u672c":"",f=f.replace("{{suggest_count}}",h),a+=f}1===s&&(t.hrefCode=c[4],t.hrefKey=c[0])}t.suggestHtml=a},a.prototype.searchByKey=function(e,t){var r=this,a="http://fangjia.fang.com/pinggu/ajax/searchtransfer.aspx",c=s.cityName;c&&"\u5168\u56fd"!==c||(c="\u5317\u4eac");var i=s.cityCode;i&&"quanguo"!==i||(i="bj"),t&&t.hrefUrl?a=t.hrefUrl:e&&e!==r.defaultText?(a=a+"?strcity="+escape(c)+"&projname="+escape(e),r.hrefCode&&r.hrefKey&&r.hrefKey===e&&(a="http://fangjia.fang.com/process/"+i+"/"+r.hrefCode+".htm")):a=a+"?strcity="+escape(c),s.aHref.href=a,s.aHref.click();var o=t;r.hrefCode?o=r.formatSearch({key:e,hrefUrl:a}):t||(o=r.formatSearch({key:e})),r.setHistory(e,o)},r.exports=new a});