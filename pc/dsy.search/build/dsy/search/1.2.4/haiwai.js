define("dsy/search/1.2.4/haiwai",["jquery","dsy/search/1.2.4/interface"],function(require,exports,module){"use strict";function HaiWaiSearch(){Search.call(this),this.tag="haiwai",this.suffix="\u6d77\u5916",this.init()}var $=require("jquery"),vars=seajs.data.vars,Search=require("dsy/search/1.2.4/interface");$.extend(HaiWaiSearch.prototype,new Search),HaiWaiSearch.prototype.init=function(){this.tpl=["<tr data-key=\"{{search_key}}\" data-search='{{search_object}}'>",'<th><p>{{suggest_word}}&nbsp;<span class="gray9">{{suggest_district}}</span></p></th>',"<td></td>","</tr>"].join(""),this.defaultText=vars.searchDefaultText.haiwai,this.historyKey=this.getHistoryKey(this.tag)},HaiWaiSearch.prototype.formatSearch=function(opts){var that=this;return{key:opts.key||"",hrefUrl:opts.hrefUrl||"",district:opts.district||"",tag:that.tag,suffix:that.suffix}},HaiWaiSearch.prototype.getSuggestHtml=function(data){var that=this,rows=data.split(","),html="";if(rows.length)for(var i=0;i<rows.length;i++){var row=rows[i].split("^"),tpl=that.tpl,key=row[0],url=row[3],obj=that.formatSearch({key:key,district:row[1],hrefUrl:url}),searchObject=JSON.stringify(obj);url&&that.urlBackup(key,searchObject),tpl=tpl.replace("{{search_key}}",obj.key),tpl=tpl.replace("{{search_object}}",searchObject),tpl=tpl.replace("{{suggest_word}}",obj.key),tpl=tpl.replace("{{suggest_district}}",obj.district),html+=tpl}that.suggestHtml=html},HaiWaiSearch.prototype.searchByKey=function(pKey,data){var key=pKey,bu=this.backup[key],so=null;bu?so=JSON.parse(bu):data&&(so=data);var url=so?so.hrefUrl:"";url=url?"http://world.fang.com/"+url:key&&key!==this.defaultText?"http://world.fang.com/house/kw"+key:"http://world.fang.com/",this.openUrl(key,url),so||(so={key:key,hrefUrl:url}),this.setHistory(key,so)},module.exports=new HaiWaiSearch});